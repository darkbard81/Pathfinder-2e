{
  "world_state": {
  "type": "object",
  "description": "캠페인의 전역 상태를 요약 / Global state of the campaign world",
  "properties": {
	  "reputation": {
	  "type": "object",
	  "description": "진영별 평판 상태 / Faction reputation status",
	  "additionalProperties": {
		  "type": "string",
		  "enum": ["Hostile (원수)", "Unfriendly (적대)", "Neutral (일반)", "Friendly (신뢰)", "Allied (아군)"]
	  }
	  },
	  "deepest_dungeon_floor": {
	  "type": "integer",
	  "minimum": 0,
	  "description": "최종 도달 던전 층수 / Deepest floor reached in dungeon"
	  },
	  "warp_markers": {
		  "type": "array",
		  "description": "워프 마커 상태 배열 / Status of warp markers placed in dungeon",
		  "items": {
		  "type": "object",
		  "properties": {
			  "floor": { "type": "integer", "description": "층수 / Dungeon floor" },
			  "status": {
			  "type": "string",
			  "enum": ["active", "used", "deactivated", "broken", "lost"],
			  "description": "현재 워프 마커 상태 / Marker state (active, used, deactivated, broken, lost)"
			  }
		  },
		  "required": ["floor", "status"]
		  }
	  }
  },
  "required": ["reputation", "deepest_dungeon_floor", "warp_markers"]
  },	
  "time_health": {
    "fatigue_check_elapsed": {
      "type": "integer",
      "description": "Elapsed minutes since last 8-hour sleep / 마지막 수면 이후 누적 경과 시간 (분 단위)"
    },
	"hunger_check_elapsed": {
      "type": "integer",
      "description": "Elapsed minutes since last 8-hour meal / 마지막 식사 이후 누적 경과 시간 (분 단위)"
    },	
    "fatigue": false,
    "hunger": false,
    "health_penalty": false
  },
  "scene_log": {
    "description": "시간 경과에 따라 탐색 흐름과 위치 상태를 기록한 배열 / Logged scene transitions, timestamps, and day transitions",
    "type": "array",
    "items": {
      "type": "object",
      "properties": {
        "scene_id": {
          "type": "integer",
          "description": "Unique ID for the scene entry / 장면 고유 ID"
        },
        "timestamp": {
          "type": "string",
          "pattern": "^Day \\d+ - \\d{2}:\\d{2}$",
          "description": "Time and day of the scene (e.g., 'Day 1 - 09:00') / 장면의 시간 정보"
        },
        "location": {
          "type": "object",
          "properties": {
            "name": { "type": "string" },
            "place_type": {
              "type": "string",
              "enum": [
                "Exploration (탐색지)", 
                "Return (귀환지)", 
                "Base (거점)",
                "Combat (전투)",
                "Social (대화/감정)",
                "Shop (상점)",
                "Ritual (의식)"
              ],
              "description": "Location place_type (English) / 장소 유형 (영문): exploration=탐색, return=귀환, base=거점, combat=전투, social=대화/감정, shop=상점, ritual=의식" 
			}
          },
          "required": ["name", "type"]
        },
        "description": {
          "type": "string",
          "description": "Scene description / 장면 설명"
        },
        "time_spent": {
          "type": "integer",
          "description": "Time consumed during this scene, in minutes / 장면에 소비된 시간 (분 단위)"
        },
        "day_advance": {
          "type": "boolean",
          "description": "Whether the day advanced after this scene / 장면 이후 날짜가 전환되었는지 여부"
        }
      },
      "required": ["scene_id", "timestamp", "location", "description", "time_spent", "day_advance"]
    }
  },
  "emotion_state": {
	"type": "array",
	"description": "현재 감정 단계 상태표 / Current emotion stage summary per character pair",
	"items": {
	  "type": "object",
	  "properties": {
		"from": {
		  "type": "string",
		  "description": "Emotion initiator / 감정 유발자"
		},
		"to": {
		  "type": "string",
		  "description": "Emotion target / 감정 대상"
		},
		"stage": {
		  "type": "integer",
		  "minimum": 0,
		  "maximum": 5,
		  "description": "Current emotional stage / 현재 감정 단계 (0~5)"
		},
		"last_updated": {
		  "type": "string",
		  "pattern": "^Day \\d+ - \\d{2}:\\d{2}$",
		  "description": "Last update timestamp / 마지막 변경 시각"
		},
		"last_trigger": {
		  "type": "string",
		  "description": "Latest cause of emotion change / 최근 변화 원인"
		}
	  },
	  "required": ["from", "to", "stage"]
	}
  },
  "emotion_log": {
    "type": "array",
    "description": "감정 관계의 변화를 시간순으로 기록한 배열 / Emotion state changes related to this scene",
    "items": {
      "type": "object",
      "properties": {
        "log_id": { "type": "integer", "description": "Log ID / 로그 고유 번호" },
        "timestamp": { "type": "string", "pattern": "^Day \\d+ - \\d{2}:\\d{2}$", "description": "Log time / 로그 시각" },
        "scene_id": { "type": "integer", "description": "Linked scene ID / 연관된 scene_log의 ID" },
        "from": { "type": "string", "description": "Emotion initiator / 감정 유발자" },
        "to": { "type": "string", "description": "Emotion target / 감정 대상" },
        "change": { "type": "string", "enum": ["+1", "-1"], "description": "Emotion change step / 감정 단계 변화 (+1 또는 -1)" },
        "new_stage": { "type": "integer", "minimum": 0, "maximum": 5, "description": "New emotional stage / 새로운 감정 단계 (0~5)" },
        "trigger": { "type": "string", "description": "Triggering cause / 변화 유발 요인" },
        "note": { "type": "string", "description": "Optional note / 비고 또는 상황 설명" }
      },
      "required": ["log_id", "timestamp", "scene_id", "from", "to", "change", "new_stage"]
    }
  },
  "inventory": {
    "description": "공용 소지품 관리 / Shared inventory tracking",
    "type": "object",
    "properties": {
      "gold_pieces": {
        "type": "integer",
        "description": "Total gold pieces / 파티 보유 금화 총량 (gp 단위)"
      },
      "shared_items": {
        "type": "array",
        "description": "파티 공유 아이템 목록 / Items shared by the whole party",
        "items": {
          "type": "object",
          "properties": {
            "name": {
              "type": "string",
              "description": "Item name / 아이템 이름"
            },
            "quantity": {
              "type": "integer",
              "description": "Number of items / 수량"
            },
            "category": {
              "type": "string",
              "description": "Item category (e.g. consumable, tool, gear) / 아이템 종류"
            },
            "notes": {
              "type": "string",
              "description": "Additional info or usage / 비고 또는 사용 용도"
            }
          },
          "required": ["name", "quantity"]
        }
      }
    },
    "required": ["gold_pieces", "shared_items"]
  },
  "level_progression": {
    "description": "Character changes per level (1~20), including HP, feats, spells, and abilities / 캐릭터가 1~20레벨에서 얻게 되는 HP, 특기, 주문, 능력치 변화 기록",
    "type": "array",
    "items": {
  	"type": "object",
  	"properties": {
  	  "name": {
  		"type": "string",
  		"description": "Character name / 캐릭터 이름"
  	  },
  	  "level": {
  		"type": "integer",
  		"description": "Character level / 캐릭터 레벨"
  	  },
  	  "hp_increase": {
  		"type": "integer",
  		"description": "HP increase at this level / 해당 레벨에서 증가한 HP"
  	  },
  	  "ability_boosts": {
  		"type": "array",
  		"items": { "type": "string" },
  		"description": "Ability scores boosted at this level / 이 레벨에서 상승한 능력치"
  	  },
  	  "class_feat": {
  		"type": "array",
  		"items": { "type": "string" },
  		"description": "Class feat(s) gained / 획득한 클래스 특기 (복수일 수 있음)"
  	  },
  	  "skill_feat": {
  		"type": "array",
  		"items": { "type": "string" },
  		"description": "Skill feat gained / 획득한 스킬 특기"
  	  },
  	  "general_feat": {
  		"type": "array",
  		"items": { "type": "string" },
  		"description": "General feat gained / 획득한 일반 특기"
  	  },
  	  "skill_increases": {
  		"type": "array",
  		"items": { "type": "string" },
  		"description": "Skills that were increased / 숙련도를 올린 스킬 목록"
  	  },
  	  "spells_gained": {
  		"type": "array",
  		"items": { "type": "string" },
  		"description": "New spells learned at this level / 해당 레벨에서 배운 주문들"
  	  },
  	  "notes": {
  		"type": "string",
  		"description": "Additional context or choices made / 선택 경위나 비고"
  	  }
  	},
  	"required": ["name", "level"]
    }
  },
  "party": {
	"description": "탐색 파티의 구성 및 각 캐릭터의 레벨, 장비, 주문 슬롯 등 전투 관련 정보",
	"leader": {
	  "type": "string",
	  "description": "현재 파티 리더의 이름"
	},
	"members": [
	  {
		"name": "string",
		"level": "number",
		"gear": {
		  "head": "string",
		  "eyes": "string",
		  "neck": "string",
		  "chest": "string",
		  "back": "string",
		  "hand": "string",
		  "finger_left": "string",
		  "finger_right": "string",
		  "waist": "string",
		  "feet": "string",
		  "armor": "string",
		  "shield": "string",
		  "weapon": "string",
		  "consumables": {
		    "type": "array",
		    "items": {
		  	"type": ["object", "null"],
		  	"properties": {
		  	  "name": { "type": "string", "description": "Item name / 아이템 이름" },
		  	  "quantity": { "type": "integer", "description": "Quantity of item / 수량" }
		  	},
		  	"required": ["name"]
		    },
		    "minItems": 5,
		    "maxItems": 5,
		    "description": "Combat-ready consumables / 전투 중 즉시 사용 가능한 소비품 슬롯 (최대 5개)"
		  }
		},
		"spells": {
		  "description": "혼합 시전자를 위한 주문 구조. prepared 캐스터와 spontaneous 캐스터를 구분하여 관리하며, 공통 포커스 주문도 포함함.",
		  "type": "object",
		  "properties": {
			"prepared": {
			  "type": "object",
			  "description": "Prepared 방식 캐스터용 주문 목록 (클래스명을 포함함)",
			  "properties": {
				"classname": {
				  "type": "string",
				  "description": "Prepared 주문을 시전하는 클래스 이름 (예: Wizard, Cleric, Warpriest 등)"
				},
				"slots": {
				  "type": "object",
				  "patternProperties": {
					"^\\d+$": {
					  "type": "object",
					  "properties": {
						"slots_total": { "type": "integer" },
						"slots_used": { "type": "integer" },
						"prepared": {
						  "type": "array",
						  "items": { "type": "string" },
						  "description": "해당 슬롯에 준비한 주문"
						}
					  },
					  "required": ["slots_total", "slots_used", "prepared"]
					}
				  }
				}
			  },
			  "required": ["classname", "slots"]
			},
			"spontaneous": {
			  "type": "object",
			  "description": "Spontaneous 방식 캐스터용 주문 목록 (클래스명을 포함함)",
			  "properties": {
				"classname": {
				  "type": "string",
				  "description": "Spontaneous 주문을 시전하는 클래스 이름 (예: Sorcerer, Oracle 등)"
				},
				"slots": {
				  "type": "object",
				  "patternProperties": {
					"^\\d+$": {
					  "type": "object",
					  "properties": {
						"slots_total": { "type": "integer" },
						"slots_used": { "type": "integer" },
						"available": {
						  "type": "array",
						  "items": { "type": "string" },
						  "description": "해당 슬롯에서 즉흥적으로 선택 가능한 주문"
						}
					  },
					  "required": ["slots_total", "slots_used", "available"]
					}
				  }
				}
			  },
			  "required": ["classname", "slots"]
			},
			"focus_points": {
			  "type": "integer",
			  "description": "현재 Focus Point 수"
			},
			"focus_spells": {
			  "type": "array",
			  "items": { "type": "string" },
			  "description": "모든 포커스 주문 목록"
			}
		  }
		}
	  }
	]
  }
  "quest_board": {
    "type": "object",
    "description": "퀘스트 게시판을 상태별로 분류한 구조 / Quest board grouped by status",
    "properties": {
      "available": {
        "type": "array",
        "items": { "$ref": "#/definitions/quest" }
      },
      "in_progress": {
        "type": "array",
        "items": { "$ref": "#/definitions/quest" }
      },
      "complete": {
        "type": "array",
        "items": { "$ref": "#/definitions/quest" }
      },
      "failed": {
        "type": "array",
        "items": { "$ref": "#/definitions/quest" }
      }
    },
    "required": ["available", "in_progress", "complete", "failed"]
  },
  "definitions": {
    "quest": {
      "type": "object",
      "properties": {
        "id": { "type": "string" },
        "name": { "type": "string" },
        "objective": { "type": "string" },
        "description": { "type": "string" },
        "giver": { "type": "string" },
        "location": { "type": "string" },
        "reward": {
          "type": "object",
          "properties": {
            "gold": { "type": "integer" },
            "items": {
              "type": "array",
              "items": { "type": "string" }
            }
          },
          "required": ["gold"]
        }
      },
      "required": ["id", "name", "objective", "description", "giver", "reward"]
    }
  }
}
